# 3.1.1函数式编程思想概述

## 纯函数
对于相同的输入，永远会得到相同的输出，而且没有任何可观察的副作用，也不依赖外部环境的状态。
例如
```js
  var arr = [1, 2, 3, 4, 5, 6];
  // 纯函数
  arr.slice(0, 3) // 1 2 3
  arr.slice(0, 3) // 1 2 3
  // 非纯函数
  arr.splice(0, 3) // 1 2 3
  arr.splice(0, 3) // 4 5 6
```
- 像`arr.slice`这种无论你怎么运行，运行的n次，他最后得到的结果永远都是跟你之前运行的结果一样的，没有依赖外部的各种环境的，并且他不会把我们的数据搞得乱七八糟的，对于这种我们称他为纯函数
- 像`arr.splice`这种只要你运行一次，那么你下次再运行的时候，这个结果跟之前不同的，并且他会把我们的原数据搞得乱七八糟的，我们称他为非纯函数
- 数学中的例子 `y = f(x)`
***注意：在javaScript中，对于数组的操作有些是纯的，有些是不纯的***

## 函数式编程为何排斥不纯的函数

因为在非纯函数中，我们除了用户所传进来的参数以外，我们还要依靠一个外部的变量，这种对于外部状态的依赖，是造成系统复杂性大大提高的主要原因
例如
```js
  var timeOfLife = 20;
  // 纯函数
  function test(age){
    return age > 20;
  }
  // 非纯函数
  function test(age){
    return age > timeOfLife;
  }
```

## 函数柯里化

为了解决上述的非纯函数依赖外部变量的问题，我们这里可以采用一种函数柯里化的手段。
函数柯里化： 向函数传递一部分参数来调用它，让它返回一个函数去处理剩下的参数
例如:

```js
  var timeOfLife = 20;
  function test(timeOfLife){
    return function(age){
      return age > timeOfLife;
    }
  }
  var testing = test(timeOfLife);
  testing(19) // false
```

个人理解：像这种我们先给他用一个函数包裹着，这个函数我们只负责传递外部的依赖变量，然后去调用它返回的结果才是我们最核心的要处理的函数
***事实上柯里化是一种“预加载”函数的方法，通过传递较少的参数，得到一个已经记住了这些参数的新函数，某种意义上讲，这是一种对参数的“缓存”，是一种非常高效的编写函数的方法***

## 函数组合

- 为避免写出不优雅的包菜式h(g(f(x))),这种一层套一层的调用函数的方式，我们需要用到函数组合。
- 我们定义的compose就像双面胶一样，可以把任何两个纯函数结合到一起，也可以扩展出组合n个函数的n面胶。
例如：
```js
  var compose = function(f, g){
    return function(x){
      return f(g(x));
    }
  }
  var mult = function(x){
    return x * 5;
  }
  var add = function(x){
    return 2 + x;
  }
  compose(mult, add)(1); // 15;
```

- 这种灵活的组合，让我们可以像拼积木一样优雅地组合函数式代码
- 其实这个个人觉得有点类似与柯里化，是柯里化的另一种写法，因为上面柯里化的定义`就是通过传递较少的参数，得到一个已经记住了这些参数的新函数`

## 声明式和命令式
### 命令式代码
通过编写一条又一条指令，让计算机执行一些动作，其中一般会涉及许多复杂的细节
例如:
```js
  var rest = [];
  var arr = [1, 2, 3, 3, 4, 2, 1];
  for (var i = 0; i < arr.length; i++) {
    if (rest.indexOf(arr[i]) < 0) {
      rest.push(arr[i]);
    }
  }
```
像这种一步一步都由我们来写的代码，里面有很多细节的地方去照顾，比如arr.length - 1会有什么结果

### 声明式代码
通过写表达式的方式，声明我们想干什么，而不是通过一步一步的指示。
例如:
```js
  var rest = arr.map(Math.sqrt);
```
像这种我们不需要涉及到复杂的细节
声明式代码，是函数式编程的一个明显好处--编写，优化代码时能更专注

## 总结
1. 函数对于外部状态的依赖，是造成系统复杂性大大提高的主要原因
2. 代码书写中让函数尽可能的纯净
3. 函数式编程不是万能的，它与oop(面向对象)一样，只是一种编程范式
4. 为降低软件复杂度，oop的方式是靠良好的继承，封装，多态以及接口定义，函数式编程则是靠纯函数以及他们的组合，柯里化等技术。